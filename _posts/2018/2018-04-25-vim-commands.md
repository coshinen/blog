---
layout: post
title:  "Vi/Vim 编辑器入门"
date:   2018-04-25 20:11:20 +0800
author: mistydew
comments: true
category: 程序人生
tags: Vi/Vim CLI Terminal
---
Vim (Vi IMproved) 是 Vi 编辑器的升级版，在 UNIX/Linux 系统中作为“编辑器之神”与“神之编辑器” Emacs 并驾齐驱。

## 模式（modes）

共分为两大模式，**命令**模式和**插入**模式。

刚进入编辑器时，默认是命令模式；转换到插入模式后，进行文本输入。

命令模式下，按 `I` 键进入插入模式；插入模式下，按 `esc` 键返回命令模式。

## 命令模式

### 插入（insert）

> * i # 从光标位置开始插入文本
> * I # （大写字母 i）从光标所在行的行首开始插入文本
> * a # 从光标的下一个位置开始插入文本
> * A # 从光标所在行的行尾开始插入文本
> * o # 从光标的下一行行首开始插入文本

### 保存并退出（write and quit）

> * :w # 保存内容
> * :q # 退出当前编辑的文档
> * :wq 或 :x # 保存内容并退出

### 移动光标

> * w # 移动光标到下个词首
> * b # 移动光标到上个词首
> * ^ # 移动光标到行首
> * $ # 移动光标到行尾
> * k # 上移，移动光标到上一行
> * j # 下移，移动光标到下一行
> * h # 左移，移动光标到上一个位置
> * l # （小写字母 L）右移，移动光标到下一个位置
> * H # 移动光标到所在页首行的行首
> * L # 移动光标到所在页尾行的行首
> * gg # 移动光标到文档首行的行首
> * G # 移动光标到文档尾行的行首
> * :n # 移动光标到第 n 行

### 选择（visual）

> * v # 进入选择模式，横向选择内容，通过移动光标进行（类似于 Windows 下的点选文字）
> * Ctrl + V # 进入选择模式，纵向选择内容，使用 I（大写字母 i）进行插入后，按 Esc 完成整个选区的修改，常用于批量注释代码段和代码对齐

### 复制（yank）

> * y^ # 复制光标的前一个位置到行首的内容
> * y$ # 复制光标到行尾的内容
> * yy # 复制光标所在行的内容
> * nyy # 复制含光标所在行在内及下面的 n 行内容

### 删除（delete）

> * x # 删除光标位置的字符
> * dd # 删除光标所在行
> * ndd # 删除含当前光标所在行在内及下面的 n 行内容
> * D # 删除光标位置到行尾的内容

**注：复制和删除共用同一个缓冲区，所以复制后删除后删除后复制会覆盖首次操作的内容。**

### 粘贴（paste）

> * p # 从光标的后一个位置开始粘贴缓冲区中（复制/删除）的内容，若使用 yy 或 dd 复制或删除行，则从光标所在行的下一行开始粘贴

### 撤销操作（undo）

> * u # 撤销上次操作，次数不限
> * Ctrl + R # 撤销上次 u 操作，次数不限

### 搜索定位

> * /xxx # 从光标所在行开始，从上往下查找 xxx 字符串并高亮所有结果，同时定位光标到第一个结果（n 选择下一个结果，N 选择上一个结果）
> * ?xxx # 从光标所在行开始，从下往上查找 xxx 字符串并高亮所有结果，同时定位光标到第一个结果（n 选择下一个结果，N 选择上一个结果）
> * % # 括号匹配，适用于 {...}、[...]、(...)

### 字符串替换（substitute）

> * :s/src/dst # 替换光标所在行内第一个 src 字符串为 dst 字符串，同时高亮全文所有 src 字符串
> * :s/src/dst/ig # 替换光标所在行内所有 src 字符串为 dst 字符串，i 表示忽略大小写，g 表示全部，同时高亮全文所有 src 字符串
> * :%s/src/dst/g # 替换整个文档内所有 src 字符串为 dst 字符串，同时高亮全文所有 src 字符串
> * :n,m s/src/dst/g # 替换第 n 行到第 m 行内所有 src 字符串为 dst 字符串，同时高亮全文所有 src 字符串

### 进制转换

> * :%!xxd # 转换整个文档为 16 进制
> * :%!xxd -r # 恢复 16 进制为原文

### 锁定和解锁（组合键）

> * Ctrl + S # 进入锁定状态
> * Ctrl + Q # 解除锁定状态

### 显示行号

> * :set nu 或 :set number # 显示行号
> * :set nonu 或 :set nonumber # 隐藏行号

## 去除行尾的换行符

**Vi/Vim 默认会在行尾添加一个换行符。**

```shell
$ vim -b <file> # -b 选项表示二进制模式
```

在命令模式使用下面命令去除最后一行行尾的换行符。

> * :set noeol # （set no end-of-line）设置无行尾结束符

## 配置文件示例

[~/.vimrc](https://github.com/mistydew/os.conf/blob/master/macOS/Users/mistydew/.vimrc){:target="_blank"}

## 参考链接

* [Vim documentation : vim online](https://www.vim.org/docs.php){:target="_blank"}
