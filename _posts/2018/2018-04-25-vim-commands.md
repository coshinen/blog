---
layout: post
title:  "Vi/Vim 基础命令"
date:   2018-04-25 20:11:20 +0800
author: mistydew
comments: true
categories: 程序人生
tags: Vi/Vim CLI Terminal
---
Vim(Vi IMproved)是 Vi 编辑器的升级版，在 UNIX/Linux 系统中作为“编辑器之神”与“神之编辑器” Emacs 并驾齐驱。

![vi-emacs-learning-curves](https://mistydew.github.io/assets/images/vim/vi-emacs-learning-curves.jpg){:.border}

（Vi/Vim 和 Emacs 的学习曲线：横坐标对应熟练度，纵坐标对应技能）

## 模式 | modes

> * 基本分为两大模式，**普通（命令）模式**和**插入模式**。
> * 普通模式为默认模式用于修改文本，插入模式用于输入文本。
> * 普通模式下按 i 键进入插入模式，插入模式下按 Esc 键返回普通模式。
> * 普通模式下可以输入命令进行文本的修改。

### 普通（命令）模式

#### 插入 | insert

> * i # 从当前光标位置开始插入文本。
> * I # 从当前光标所在行的行首开始插入文本。
> * a # 从当前光标的后一个位置开始插入文本。
> * A # 从当前光标所在行的行尾开始插入文本。
> * o # 从当前光标所在行的下一行的行首开始插入文本。

#### 保存和退出 | write and quit

> * :w # 保存当前内容。
> * :q # 退出当前文档，前提：内容未改变 或 改变的内容已保存。
> * :wq 或 :x # 保存并退出。

#### 移动光标

> * w # 移动光标到下一个单词。
> * b # 移动光标到上一个单词。
> * ^ # 移动光标到所在行的行首。
> * $ # 移动光标到所在行的行尾。
> * k # 上移，移动光标到所在行的上一行。
> * j # 下移，移动光标到所在行的下一行。
> * h # 左移，移动光标到所在位置的前一个位置。
> * l # 右移（小写字母 L），移动光标到所在位置的后一个位置。
> * H # 移动光标到所在页首行的行首。
> * L # 移动光标到所在页尾行的行首。
> * gg # 移动光标到文档首行的行首。
> * G # 移动光标到文档尾行的行首。

#### 选择 | visual

> * v # 进入选择模式，横向选择字符串，使用上下左右移动光标来进行选择，类似于 Windows 下鼠标左键点选文字。
> * V # 进入选择模式，纵向选择字符串，使用 I（大写字母 i）进行插入，一行输入完成后按 Esc 完成整个选中区域的修改，常用于”批量注释代码段“或“代码对齐”。

#### 复制 | yank

> * y^ # 复制当前光标的前一个位置到行首的内容。
> * y$ # 复制当前光标所在位置到行尾的内容。
> * yy # 复制当前光标所在行的内容。
> * nyy # n 表示行数，复制包含当前光标所在行之后的 n 行的内容。

#### 粘贴 | paste

> * p # 从当前光标的后一个位置开始粘贴缓冲区中（复制/删除）的内容，若使用 yy 复制行，则从当前光标所在行的下一行开始粘贴。

#### 删除（剪切） | delete

> * x # 删除当前光标所在位置的字符，并送入缓冲区。
> * dd # 删除当前光标所在行的内容，并送入缓冲区。
> * ndd # n 表示数字，删除包含当前光标所在行之后的 n 行的内容，并送入缓冲区。
> * D # 删除当前光标所在位置到行尾的内容，并送入缓冲区，常用于删除注释。

**注：复制和删除（剪切）共用同一个缓冲区，所以“复制后删除”或“剪切后复制”均会覆盖第一次操作的内容。**

#### 撤销操作 | undo

> * u # 撤销上次（最近一次）操作，使用次数不限。
> * R # 撤销上次（最近一次） u 操作，使用次数不限。

#### 搜索和定位

> * /xxx # 从光标当前所在行开始，查找 xxx 字符串并高亮所有结果，同时定位光标到第一个结果，大小写不敏感。从上往下搜索。
> * ?xxx # 同上，从下往上搜索。n 选择下一个结果，N 选择上一个结果。
> * :n # 跳转到第 n 行。
> * % # 括号匹配，适用于 {...}、[...]、(...)。

#### 字符串替换 | substitute

> * :s/src/dst # 替换当前光标所在行内第一个 src 字符串为 dst 字符串，同时高亮全文所有 src 字符串。
> * :s/src/dst/ig # 替换当前光标所在行内所有 src 字符串为 dst 字符串，i 表示忽略大小写，g 表示全部，同时高亮全文所有 src 字符串。
> * :n,m s/src/dst/g # 替换第 n 行到第 m 行内所有 src 字符串为 dst 字符串，同时高亮全文所有 src 字符串。
> * :%s/src/dst/g # 替换文档内所有 src 字符串为 dst 字符串，同时高亮全文所有 src 字符串。

#### 进制转换

> * :%!xxd # 转换全文为 16 进制。
> * :%!xxd -r # 恢复 16 进制为原文。

#### 锁定和解锁（组合键）

> * Ctrl + s # 进入锁定状态，即不响应除 xxx （见下一条命令）的输入。
> * Ctrl + q # 解除锁定状态。

#### 显示行号

> * :set nu 或 :set number # 显示行号。
> * :set nonu 或 :set nonumber # 隐藏行号。

### 插入模式

码字即可。

## 去除行尾的换行符

**Vi/Vim 默认会在行尾添加一个换行符。**

```shell
$ vim -b <file> # -b 选项表示二进制模式。
```

在命令模式使用下面命令去除最后一行行尾的换行符。

> * :set noeol # 设置无行尾结束符（set no end-of-line）。

## 配置文件示例

[~/.vimrc](https://github.com/mistydew/os.conf/blob/master/macOS/Users/mistydew/.vimrc){:target="_blank"}

## 参考链接

* [welcome home : vim online](https://www.vim.org){:target="_blank"}
* [vim/vim: The official Vim repository](https://github.com/vim/vim){:target="_blank"}
